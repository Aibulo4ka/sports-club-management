# ПОЯСНИТЕЛЬНАЯ ЗАПИСКА

К КУРСОВОМУ ПРОЕКТУ ПО ДИСЦИПЛИНЕ
"ПРОЕКТИРОВАНИЕ ИНФОРМАЦИОННЫХ СИСТЕМ"

ТЕМА: АВТОМАТИЗИРОВАННАЯ СИСТЕМА УПРАВЛЕНИЯ СПОРТИВНЫМ КЛУБОМ

Выполнил: студент 3 курса
Дата: 2025 год

## СОДЕРЖАНИЕ

1. ВВЕДЕНИЕ
2. АНАЛИЗ ПРЕДМЕТНОЙ ОБЛАСТИ
3. ПРОЕКТИРОВАНИЕ СИСТЕМЫ
4. АРХИТЕКТУРА И ТЕХНОЛОГИИ
5. РЕАЛИЗАЦИЯ СИСТЕМЫ
6. ТЕСТИРОВАНИЕ
7. ЗАКЛЮЧЕНИЕ
8. СПИСОК ИСПОЛЬЗОВАННЫХ ИСТОЧНИКОВ
9. ПРИЛОЖЕНИЯ

## 1. ВВЕДЕНИЕ

### 1.1. Актуальность

В современных условиях спортивные клубы и фитнес-центры сталкиваются с необходимостью эффективного управления большим объёмом информации: клиентская база, абонементы, расписание занятий, финансовые операции, работа тренерского состава. Ручное управление этими процессами приводит к ошибкам, потере данных и снижению качества обслуживания клиентов.

Автоматизация процессов управления спортивным клубом позволяет повысить качество обслуживания клиентов, оптимизировать загрузку тренеров и залов, автоматизировать финансовые расчёты и учёт платежей, предоставить клиентам удобный онлайн-доступ к расписанию и бронированию, обеспечить прозрачность и контроль всех бизнес-процессов.

### 1.2. Цель работы

Разработка автоматизированной системы управления спортивным клубом, обеспечивающей полный цикл работы с клиентами: от регистрации и покупки абонемента до бронирования занятий и получения персонализированных рекомендаций от AI-тренера.

### 1.3. Задачи проекта

1. Провести анализ предметной области и существующих решений
2. Спроектировать архитектуру системы и модель данных
3. Реализовать систему управления пользователями с ролевой моделью доступа
4. Разработать модули управления абонементами с гибкой системой скидок
5. Создать систему бронирования групповых и персональных занятий
6. Интегрировать платёжную систему для онлайн-оплаты
7. Разработать dashboard для аналитики и отчётности
8. Реализовать систему email-уведомлений
9. Интегрировать AI-ассистента для персонализированных рекомендаций
10. Провести тестирование системы
11. Подготовить документацию

### 1.4. Объект и предмет исследования

Объект исследования: Бизнес-процессы управления спортивным клубом

Предмет исследования: Методы и средства автоматизации управления спортивным клубом

## 2. АНАЛИЗ ПРЕДМЕТНОЙ ОБЛАСТИ

### 2.1. Описание предметной области

Спортивный клуб представляет собой коммерческую организацию, предоставляющую услуги в области фитнеса и спорта. Основные участники процессов:

1. Клиенты - посетители клуба, приобретающие абонементы и записывающиеся на занятия
2. Тренеры - специалисты, проводящие групповые и персональные тренировки
3. Администраторы - сотрудники, управляющие системой и контролирующие все процессы

### 2.2. Основные бизнес-процессы

#### 2.2.1. Управление клиентами

Процесс включает регистрацию новых клиентов, ведение профилей с личными данными и фотографией, учёт статуса (обычный клиент или студент для применения скидок), хранение истории посещений и платежей.

#### 2.2.2. Управление абонементами

Процесс включает создание и настройку типов абонементов, гибкую систему ценообразования, применение скидок (студенческие, длительные абонементы), контроль срока действия и остатка посещений, автоматическую деактивацию истёкших абонементов.

#### 2.2.3. Расписание и бронирование

Процесс включает формирование расписания групповых занятий, назначение тренеров на занятия, онлайн-бронирование мест клиентами, контроль лимита участников, управление статусами бронирования (подтверждено, отменено, завершено).

#### 2.2.4. Финансовые операции

Процесс включает онлайн-оплату абонементов через платёжный шлюз, учёт всех транзакций, формирование финансовой отчётности.

#### 2.2.5. Аналитика и отчётность

Процесс включает формирование dashboard с ключевыми метриками (выручка, активные клиенты, занятия), построение графиков динамики показателей, анализ загрузки тренеров.

### 2.3. Обзор существующих решений

На рынке представлены решения для автоматизации фитнес-клубов.

FitnessPro является российской CRM-системой с полным функционалом для управления клубом, однако имеет высокую стоимость (от 5000 рублей в месяц) и избыточный функционал для малых клубов.

GymMaster является международной платформой с мощной аналитикой, но не имеет русскоязычной локализации и сложна в интеграции с российскими платёжными системами.

ClubExpert является облачным решением с доступной ценой, но имеет ограниченные возможности кастомизации и отсутствие AI-функций.

### 2.4. Обоснование необходимости разработки

Существующие решения имеют следующие недостатки: высокая стоимость владения, недостаточная гибкость настройки под конкретные бизнес-процессы, отсутствие современных AI-функций для персонализации, сложность интеграции с российскими сервисами.

Разработка собственной системы позволяет создать решение, точно соответствующее требованиям, минимизировать затраты на внедрение и поддержку, интегрировать современные технологии, обеспечить полный контроль над данными.

## 3. ПРОЕКТИРОВАНИЕ СИСТЕМЫ

### 3.1. Функциональные требования

#### 3.1.1. Управление пользователями

FR-1.1: Регистрация с email-подтверждением
FR-1.2: Аутентификация (web-сессии и JWT для API)
FR-1.3: Ролевая модель доступа (CLIENT, TRAINER, ADMIN)
FR-1.4: Управление профилями с аватарами
FR-1.5: Восстановление пароля

#### 3.1.2. Управление абонементами

FR-2.1: Каталог типов абонементов
FR-2.2: Расчёт цены с учётом скидок (паттерн Strategy)
FR-2.3: Покупка абонемента с онлайн-оплатой
FR-2.4: Просмотр активных абонементов
FR-2.5: Автоматическое списание посещений

#### 3.1.3. Бронирование занятий

FR-3.1: Просмотр расписания с фильтрами
FR-3.2: Бронирование с проверкой лимитов
FR-3.3: Отмена бронирования
FR-3.4: История посещений

#### 3.1.4. Платёжная система

FR-4.1: Создание платежа в YooKassa
FR-4.2: Обработка webhook-уведомлений
FR-4.3: История платежей клиента
FR-4.4: Демо-режим с mock-заглушкой

#### 3.1.5. Тренерский кабинет

FR-5.1: Просмотр своих занятий
FR-5.2: Просмотр списков участников
FR-5.3: Статистика проведённых тренировок

#### 3.1.6. Dashboard и аналитика

FR-6.1: Ключевые метрики (выручка, клиенты, занятия)
FR-6.2: Графики динамики показателей
FR-6.3: Топ-тренеры по количеству занятий

#### 3.1.7. AI Персональный тренер

FR-7.1: Анализ профиля клиента (рост, вес, цели)
FR-7.2: Генерация персонального плана тренировок
FR-7.3: Составление плана питания
FR-7.4: Рекомендации по занятиям из расписания

#### 3.1.8. Email-уведомления

FR-8.1: Приветственное письмо при регистрации
FR-8.2: Уведомление за 3 дня до истечения абонемента
FR-8.3: Автоматическая рассылка по расписанию

### 3.2. Нефункциональные требования

#### 3.2.1. Производительность

NFR-1.1: Время отклика web-интерфейса менее 2 секунд
NFR-1.2: API endpoint response time менее 500 миллисекунд
NFR-1.3: Поддержка до 1000 одновременных пользователей

#### 3.2.2. Безопасность

NFR-2.1: Хеширование паролей (PBKDF2)
NFR-2.2: CSRF-защита для всех форм
NFR-2.3: Rate limiting для API (100 запросов в час)
NFR-2.4: SQL injection prevention через ORM

#### 3.2.3. Масштабируемость

NFR-3.1: Модульная архитектура Django приложений
NFR-3.2: Асинхронная обработка задач через Celery
NFR-3.3: Готовность к горизонтальному масштабированию

#### 3.2.4. Удобство использования

NFR-4.1: Адаптивный интерфейс (Bootstrap 5)
NFR-4.2: Интуитивная навигация
NFR-4.3: Современный дизайн

### 3.3. Use Case диаграмма

Основные сценарии использования системы:

Клиент выполняет следующие действия: регистрация и вход в систему, просмотр каталога абонементов, покупка абонемента с онлайн-оплатой, просмотр расписания занятий, бронирование места на занятие, получение рекомендаций от AI-тренера, просмотр истории платежей.

Тренер выполняет следующие действия: вход в систему, просмотр своего расписания, просмотр списков участников, просмотр статистики тренировок.

Администратор выполняет следующие действия: управление пользователями, создание типов абонементов, формирование расписания, просмотр Dashboard с аналитикой, просмотр финансовой отчётности.

### 3.4. Модель данных

#### 3.4.1. Основные сущности

Сущность User (Пользователь) содержит следующие атрибуты: id (первичный ключ), username (уникальный), email (уникальный), password (хешированный), first_name, last_name, is_active, is_staff.

Сущность Profile (Профиль) содержит следующие атрибуты: id (первичный ключ), user (внешний ключ на User, связь один к одному), role (перечисление: CLIENT, TRAINER, ADMIN), phone (телефон), avatar (фотография профиля), birth_date (дата рождения), gender (пол), address (адрес).

Сущность Client (Клиент) содержит следующие атрибуты: id (первичный ключ), profile (внешний ключ на Profile), is_student (булево значение для скидок), height (рост для AI), weight (вес для AI), fitness_goal (цель тренировок).

Сущность Trainer (Тренер) содержит следующие атрибуты: id (первичный ключ), profile (внешний ключ на Profile), specialization (специализация), experience_years (стаж), bio (биография).

Сущность MembershipType (Тип абонемента) содержит следующие атрибуты: id (первичный ключ), name (название), description (описание), price (базовая цена), duration_days (длительность), visits_limit (лимит посещений, NULL означает безлимит), is_active (активность).

Сущность Membership (Абонемент) содержит следующие атрибуты: id (первичный ключ), client (внешний ключ на Client), membership_type (внешний ключ на MembershipType), start_date и end_date (период действия), status (перечисление: ACTIVE, SUSPENDED, EXPIRED), visits_remaining (остаток посещений).

Сущность Class (Занятие) содержит следующие атрибуты: id (первичный ключ), trainer (внешний ключ на Trainer), name (название), description (описание), class_type (тип: групповое или персональное), scheduled_at (дата и время), duration_minutes (длительность), capacity (лимит участников), status (перечисление: SCHEDULED, COMPLETED, CANCELLED).

Сущность Booking (Бронирование) содержит следующие атрибуты: id (первичный ключ), client (внешний ключ на Client), class_session (внешний ключ на Class), status (перечисление: CONFIRMED, CANCELLED, COMPLETED), booked_at (время бронирования).

Сущность Payment (Платёж) содержит следующие атрибуты: id (первичный ключ), client (внешний ключ на Client), membership (внешний ключ на Membership), amount (сумма типа Decimal), status (перечисление: PENDING, COMPLETED, FAILED, REFUNDED), payment_method (перечисление: YOOKASSA, CASH, CARD), transaction_id (идентификатор в платёжной системе), payment_url (URL для оплаты), created_at и completed_at (временные метки).

#### 3.4.2. Связи между сущностями

User связан с Profile отношением один к одному.
Profile связан с Client отношением один к одному.
Profile связан с Trainer отношением один к одному.
Client связан с Membership отношением один ко многим.
MembershipType связан с Membership отношением один ко многим.
Membership связан с Payment отношением один ко многим.
Client связан с Booking отношением один ко многим.
Client связан с Payment отношением один ко многим.
Trainer связан с Class отношением один ко многим.
Class связан с Booking отношением один ко многим.

## 4. АРХИТЕКТУРА И ТЕХНОЛОГИИ

### 4.1. Архитектурный паттерн

Система построена по архитектурному паттерну MTV (Model-Template-View), характерному для Django. Model отвечает за модели данных и бизнес-логику, Template отвечает за HTML-шаблоны для отображения, View отвечает за обработчики запросов и связующее звено. Дополнительно применяется REST API архитектура для мобильных клиентов и интеграций.

### 4.2. Технологический стек

#### 4.2.1. Backend

Python 3.11 используется в качестве основного языка программирования.
Django 4.2 используется в качестве web-framework.
Django REST Framework 3.14 используется для создания REST API.
PostgreSQL 15 используется в качестве реляционной СУБД.
Redis 7 используется для кеширования и в качестве брокера сообщений.
Celery 5 используется для выполнения асинхронных задач.
Celery Beat используется для выполнения периодических задач.

#### 4.2.2. Frontend

HTML5 и CSS3 используются для вёрстки.
Bootstrap 5 используется в качестве CSS-framework.
Bootstrap Icons используется для отображения иконок.
Chart.js используется для графиков и визуализации данных.
Vanilla JavaScript используется для клиентской логики.

#### 4.2.3. Интеграции

YooKassa используется в качестве платёжного шлюза с mock-заглушкой для демонстрации.
Anthropic Claude API используется в качестве AI-ассистента для персонализированных рекомендаций.
SMTP (Gmail) используется для отправки email-уведомлений.

#### 4.2.4. DevOps

Git используется в качестве системы контроля версий.
Docker используется для контейнеризации (опционально).
python-decouple используется для управления конфигурацией.

### 4.3. Структура проекта

Проект имеет следующую структуру каталогов:

Каталог backend является корневым каталогом проекта.

Каталог apps содержит Django приложения:
- accounts содержит модели User, Profile, Client, Trainer и логику аутентификации
- memberships содержит модели MembershipType, Membership и систему ценообразования
- classes содержит модели Class
- bookings содержит модели Booking
- payments содержит модели Payment и интеграцию с платёжными системами
- facilities содержит модели помещений и оборудования
- analytics содержит Dashboard и аналитику

Каталог config содержит конфигурацию проекта:
- settings содержит файлы base.py (общие настройки), dev.py (разработка), prod.py (production)
- urls.py содержит главный роутинг
- celery.py содержит конфигурацию Celery

Каталог templates содержит общие HTML шаблоны.
Каталог static содержит статические файлы (CSS, JavaScript, изображения).
Каталог media содержит загружаемые файлы (аватары пользователей).
Каталог tests содержит автоматические тесты.

### 4.4. Применённые паттерны проектирования

#### 4.4.1. Strategy (Стратегия)

Паттерн Strategy применён в системе скидок для абонементов. Создан абстрактный базовый класс DiscountStrategy с методом calculate_discount. Реализованы конкретные стратегии: NoDiscountStrategy (без скидки), StudentDiscountStrategy (15 процентов для студентов), LongTermDiscountStrategy (10 процентов для абонементов длительностью 90 и более дней).

Преимущества данного подхода: легко добавлять новые типы скидок без изменения существующего кода, возможность комбинировать несколько стратегий, независимое тестирование каждой стратегии.

#### 4.4.2. Factory (Фабрика)

Паттерн Factory применён для выбора платёжного сервиса между реальной YooKassa и mock-заглушкой. Функция get_payment_service проверяет настройку USE_MOCK_PAYMENTS и возвращает соответствующую реализацию сервиса.

Преимущества данного подхода: единая точка создания объектов, лёгкое переключение между реализациями, упрощённое тестирование.

#### 4.4.3. Singleton (Одиночка)

Паттерн Singleton применён для платёжных сервисов (YooKassa, Mock). Функции get_yookassa_service и get_mock_payment_service возвращают единственный экземпляр сервиса на весь lifecycle приложения.

Преимущества данного подхода: единственный экземпляр на весь lifecycle приложения, экономия памяти, предотвращение множественной инициализации API-клиентов.

#### 4.4.4. Observer (Наблюдатель)

Паттерн Observer применён через механизм Django signals для автоматических действий. Например, signal post_save на модели User запускает отправку приветственного письма при создании нового пользователя.

Преимущества данного подхода: разделение логики создания объекта и побочных эффектов, возможность подписывать несколько обработчиков на одно событие.

### 4.5. REST API

Система предоставляет полноценный REST API для мобильных приложений и интеграций.

Аутентификация выполняется через JWT (JSON Web Tokens).

Основные эндпоинты API:

POST /api/v1/auth/register/ выполняет регистрацию пользователя.
POST /api/v1/auth/login/ выполняет получение JWT токена.
POST /api/v1/auth/refresh/ выполняет обновление токена.

GET /api/v1/memberships/types/ возвращает список типов абонементов.
GET /api/v1/memberships/my/ возвращает абонементы текущего пользователя.
POST /api/v1/memberships/purchase/ выполняет покупку абонемента.

GET /api/v1/classes/ возвращает расписание занятий.
GET /api/v1/classes/{id}/ возвращает детали конкретного занятия.

GET /api/v1/bookings/my/ возвращает бронирования текущего пользователя.
POST /api/v1/bookings/ создаёт новое бронирование.
DELETE /api/v1/bookings/{id}/cancel/ отменяет бронирование.

GET /api/v1/payments/my/ возвращает историю платежей.
POST /api/v1/payments/create/ создаёт новый платёж.
POST /api/v1/payments/webhook/ обрабатывает webhook от YooKassa.

GET /api/v1/trainers/ возвращает список тренеров.

### 4.6. Безопасность

#### 4.6.1. Защита от угроз

SQL Injection предотвращается использованием Django ORM и подготовленных запросов.
XSS предотвращается автоматическим экранированием в Django templates.
CSRF предотвращается использованием CSRF tokens для всех форм.
Хранение паролей осуществляется с использованием алгоритма хеширования PBKDF2.
Rate Limiting применяется для API (100 запросов в час).
HTTPS является обязательным для production окружения.

#### 4.6.2. Ролевая модель доступа

Доступ к функциям системы контролируется через декораторы login_required и проверку роли пользователя. Например, доступ к Dashboard ограничен только для пользователей с флагом is_staff.

## 5. РЕАЛИЗАЦИЯ СИСТЕМЫ

### 5.1. Спринт 1: Базовая инфраструктура и управление пользователями

В рамках первого спринта выполнены следующие задачи: настройка Django проекта и структуры приложений, создание моделей User, Profile, Client, Trainer, реализация регистрации и аутентификации (web и API), реализация управления профилями с аватарами.

Ключевые компоненты:

Модель Profile расширяет стандартную модель User дополнительными полями. Поле role принимает значения CLIENT, TRAINER или ADMIN. Поле user связано с моделью User через отношение OneToOneField. Дополнительно хранятся телефон, аватар, дата рождения.

Процесс регистрации реализован в классе RegisterView, который после сохранения пользователя создаёт профиль с выбранной ролью и отправляет приветственное письмо через Celery task.

### 5.2. Спринт 2: Система абонементов и ценообразование

В рамках второго спринта выполнены следующие задачи: создание моделей MembershipType и Membership, реализация каталога абонементов, реализация системы скидок с использованием паттерна Strategy, создание калькулятора цен.

Ключевые компоненты:

Модель MembershipType представляет шаблон абонемента с полями name, description, price, duration_days, visits_limit и is_active. Поле visits_limit может принимать значение NULL для безлимитных абонементов.

Модель Membership представляет купленный абонемент клиентом с полями client, membership_type, start_date, end_date, status и visits_remaining.

Функция get_best_discount_strategy выбирает наиболее выгодную стратегию скидки на основе статуса студента и длительности абонемента. Для клиентов, являющихся студентами и покупающих абонементы длительностью 90 и более дней, применяется комбинированная скидка.

### 5.3. Спринт 3: Занятия и бронирования

В рамках третьего спринта выполнены следующие задачи: создание моделей Class и Booking, реализация расписания с фильтрацией, реализация бронирования с проверкой лимитов, реализация отмены бронирований.

Ключевые компоненты:

Модель Class представляет занятие в расписании с полями trainer, name, description, class_type, scheduled_at, duration_minutes, capacity и status. Свойство available_spots вычисляет количество свободных мест путём вычитания количества подтверждённых бронирований из общей вместимости.

Класс BookingCreateView реализует создание бронирования с проверками: наличие свободных мест на занятии, наличие активного абонемента у клиента, соответствие дат. После создания бронирования выполняется списание одного посещения из абонемента (если абонемент не безлимитный).

### 5.4. Спринт 4: Платёжная система

В рамках четвёртого спринта выполнены следующие задачи: интеграция YooKassa API, создание mock-заглушки для демо-режима, реализация обработки webhook-уведомлений, реализация истории платежей.

Ключевые компоненты:

Класс YooKassaService инкапсулирует работу с API YooKassa. Метод create_payment создаёт платёж в системе YooKassa с указанием суммы, описания, email клиента, URL возврата и метаданных. Возвращается объект с полями payment_id, confirmation_url и status.

Функция get_payment_service реализует паттерн Factory для автоматического выбора между реальной интеграцией YooKassa и mock-заглушкой. Выбор осуществляется на основе настройки USE_MOCK_PAYMENTS. В случае недоступности YooKassa автоматически используется mock-сервис.

Класс YooKassaWebhookView обрабатывает уведомления от платёжной системы. При получении события payment.succeeded извлекается payment_id из метаданных, обновляется статус платежа на COMPLETED и активируется связанный абонемент.

### 5.5. Спринт 5: Dashboard и аналитика

В рамках пятого спринта выполнены следующие задачи: создание Dashboard для администраторов, реализация ключевых метрик (KPI), создание графиков с использованием Chart.js, создание отчётов по тренерам.

Ключевые компоненты:

Класс DashboardView формирует контекст с аналитическими данными. Вычисляется общая выручка путём суммирования всех завершённых платежей, количество активных абонементов, количество запланированных занятий. Метод get_revenue_by_month возвращает данные о выручке по месяцам за последние 6 месяцев с использованием аннотации TruncMonth.

Визуализация выполнена с использованием библиотеки Chart.js. Данные передаются из Django view в JavaScript через безопасную сериализацию. Построены графики типа line для отображения динамики выручки.

### 5.6. Спринт 6: Email-уведомления и AI-тренер

В рамках шестого спринта выполнены следующие задачи: настройка Celery для асинхронных задач, реализация email-уведомлений при регистрации, реализация напоминаний об истечении абонемента, интеграция AI-ассистента с Claude API.

Ключевые компоненты:

Celery task send_membership_expiry_reminders выполняется ежедневно в 9:00 часов по расписанию Celery Beat. Задача находит все активные абонементы, срок действия которых истекает через 3 дня, и отправляет email-уведомления соответствующим клиентам.

Celery task deactivate_expired_memberships выполняется ежедневно в 1:00 час. Задача находит все активные абонементы с датой окончания меньше текущей даты и устанавливает им статус EXPIRED.

Класс AITrainerService инкапсулирует работу с Anthropic Claude API. Метод generate_workout_plan принимает объект Client, формирует персонализированный промпт с данными о возрасте, росте, весе, цели и уровне подготовки, отправляет запрос к Claude API и возвращает сгенерированный план тренировок.

### 5.7. Интерфейс пользователя

Система имеет адаптивный интерфейс на основе Bootstrap 5.

Реализованы следующие страницы: главная страница с hero section и призывом к действию, каталог абонементов с карточками типов абонементов, расписание занятий с таблицей и фильтрами по дате тренеру и типу, профиль пользователя с возможностью редактирования данных и загрузки аватара, Dashboard с графиками и метриками для администраторов, кабинет тренера с расписанием и списками участников, AI Тренер с персонализированными рекомендациями.

## 6. ТЕСТИРОВАНИЕ

### 6.1. Стратегия тестирования

Применяется многоуровневое тестирование:

Unit tests выполняют тестирование отдельных функций и методов.
Integration tests выполняют тестирование взаимодействия компонентов.
API tests выполняют тестирование REST API endpoints.
Manual testing выполняет ручное тестирование пользовательского интерфейса.

### 6.2. Покрытие тестами

Всего написано 239 автоматических тестов, из которых 196 проходит успешно, что составляет 82 процента.

### 6.3. Примеры тестов

#### 6.3.1. Тестирование системы скидок

Тест test_student_discount проверяет корректность применения студенческой скидки 15 процентов. Создаётся экземпляр стратегии StudentDiscountStrategy, передаётся базовая цена 1000 рублей, проверяется что рассчитанная скидка равна 150 рублям.

Тест test_long_term_discount проверяет корректность применения скидки на длительные абонементы. Для абонементов длительностью 90 и более дней применяется скидка 10 процентов. Для абонементов длительностью менее 90 дней скидка не применяется.

#### 6.3.2. Тестирование бронирования

Метод setUp создаёт тестовое окружение: пользователя с ролью CLIENT, активный абонемент с 10 оставшимися посещениями, занятие с вместимостью 10 человек.

Тест test_booking_creation проверяет успешное создание бронирования. После создания бронирования со статусом CONFIRMED проверяется что у абонемента списалось одно посещение и осталось 9.

Тест test_booking_when_no_spots проверяет поведение при отсутствии свободных мест. Создаётся 10 бронирований для заполнения всех мест. Попытка создать 11-е бронирование должна вызвать ValidationError.

#### 6.3.3. Тестирование API

Тест test_auth_jwt проверяет JWT аутентификацию. Создаётся пользователь с логином и паролем. Выполняется POST запрос на эндпоинт /api/v1/auth/login/ с учётными данными. Проверяется что в ответе присутствуют поля access и refresh с JWT токенами. Полученный токен используется для доступа к защищённому эндпоинту /api/v1/memberships/my/ через заголовок Authorization Bearer.

### 6.4. Результаты тестирования

Статистика тестирования: всего тестов 239, успешных 196 (82 процента), провальных 43 (18 процентов).

Основные причины непройденных тестов: некоторые тесты требуют настройки Celery для выполнения email tasks, тесты с реальными API (YooKassa) отключены в режиме разработки, legacy тесты для удалённого функционала.

Ручное тестирование подтвердило корректную работу следующих сценариев: регистрация и вход клиента, покупка абонемента через mock-платежи, бронирование занятий, отмена бронирований с возвратом посещений, тренерский кабинет, Dashboard с графиками, AI-тренер генерация планов, email-уведомления при регистрации.

## 7. ЗАКЛЮЧЕНИЕ

### 7.1. Результаты работы

В результате выполнения курсового проекта была разработана полнофункциональная Автоматизированная система управления спортивным клубом.

Реализованный функционал включает: систему управления пользователями с ролевой моделью (CLIENT, TRAINER, ADMIN), модуль управления абонементами с гибкой системой скидок, систему бронирования групповых и персональных занятий, интеграцию платёжной системы (YooKassa с mock-заглушкой для демонстрации), Dashboard с аналитикой и визуализацией данных, email-уведомления (приветственные письма и напоминания), AI Персональный тренер для генерации рекомендаций, REST API для мобильных приложений.

Применённые технологии: Backend реализован на Django 4.2, PostgreSQL, Celery, Redis. Frontend реализован на Bootstrap 5 и Chart.js. Интеграции включают YooKassa и Anthropic Claude API. Применены паттерны проектирования: Strategy, Factory, Singleton, Observer.

Показатели качества: написано 239 автоматических тестов с успешностью 82 процента, реализована модульная архитектура из 8 Django приложений, REST API с JWT-аутентификацией, адаптивный пользовательский интерфейс.

### 7.2. Достижение поставленных целей

Цель достигнута: создана автоматизированная система, обеспечивающая полный цикл работы спортивного клуба.

Решены все поставленные задачи: проведён анализ предметной области, спроектирована архитектура и модель данных, реализована система управления пользователями, разработан модуль абонементов с паттерном Strategy, создана система бронирования, интегрирована платёжная система, разработан Dashboard с аналитикой, реализованы email-уведомления, интегрирован AI-ассистент, проведено тестирование, подготовлена документация.

### 7.3. Практическая значимость

Разработанная система может быть использована малыми и средними фитнес-клубами для автоматизации работы, в качестве основы для коммерческого продукта SaaS, как учебный проект для изучения Django и паттернов проектирования.

Преимущества перед аналогами: бесплатное open-source решение, полная кастомизация под нужды бизнеса, современный технологический стек, интеграция AI для персонализации, готовый REST API для мобильных приложений.

### 7.4. Возможности развития

Краткосрочные улучшения: мобильное приложение (React Native и REST API), push-уведомления для напоминаний о тренировках, QR-код абонементов для быстрого прохода, интеграция с фитнес-трекерами (Apple Health, Google Fit), онлайн-трансляции занятий (интеграция Zoom или YouTube).

Долгосрочные планы: Machine Learning для прогнозирования загрузки, чат-бот в Telegram для быстрого бронирования, маркетинговые инструменты (email-кампании, промокоды), программа лояльности и реферальная система, CRM-функционал для работы с лидами.

Масштабирование: multi-tenancy архитектура для SaaS-модели, микросервисная архитектура для высоких нагрузок, Kubernetes для автоматического scaling, CDN для статики и медиа-файлов.

### 7.5. Личный опыт

В ходе работы над проектом были получены практические навыки: проектирование архитектуры веб-приложений, применение паттернов проектирования в реальных задачах, работа с Django ORM и сложными запросами, интеграция сторонних API и сервисов, асинхронная обработка задач с Celery, тестирование и отладка backend-логики, разработка REST API, работа с PostgreSQL.

Проект продемонстрировал важность правильного проектирования на ранних этапах. Модульная архитектура позволила легко добавлять новый функционал в каждом спринте без переписывания существующего кода. Применение паттернов проектирования (Strategy, Factory) сделало систему гибкой и расширяемой.

## 8. СПИСОК ИСПОЛЬЗОВАННЫХ ИСТОЧНИКОВ

Официальная документация:

1. Django Documentation (4.2). URL: https://docs.djangoproject.com/en/4.2/
2. Django REST Framework. URL: https://www.django-rest-framework.org/
3. Celery Documentation. URL: https://docs.celeryq.dev/
4. PostgreSQL 15 Documentation. URL: https://www.postgresql.org/docs/15/
5. Bootstrap 5 Documentation. URL: https://getbootstrap.com/docs/5.3/
6. Chart.js Documentation. URL: https://www.chartjs.org/docs/

API и сервисы:

7. YooKassa API. URL: https://yookassa.ru/developers/api
8. Anthropic Claude API. URL: https://docs.anthropic.com/

Книги:

9. Percival H., Gregory D. Test-Driven Development with Python. O'Reilly, 2023.
10. Gamma E., Helm R., Johnson R., Vlissides J. Design Patterns: Elements of Reusable Object-Oriented Software. Addison-Wesley, 1994.
11. Greenfeld D.R., Greenfeld A.R. Two Scoops of Django 3.x. 2021.

Веб-ресурсы:

12. Real Python. Django Tutorials. URL: https://realpython.com/
13. Stack Overflow. URL: https://stackoverflow.com/
14. GitHub. URL: https://github.com/

## 9. ПРИЛОЖЕНИЯ

### Приложение А. Структура базы данных

Основные таблицы:

auth_user (встроенная таблица Django)
accounts_profile
accounts_client
accounts_trainer
memberships_membershiptype
memberships_membership
classes_class
bookings_booking
payments_payment
facilities_facility

Связи:

User связан с Profile отношением 1:1
Profile связан с Client отношением 1:1
Profile связан с Trainer отношением 1:1
Client связан с Membership отношением 1:N
Client связан с Booking отношением 1:N
Trainer связан с Class отношением 1:N
Class связан с Booking отношением 1:N
Membership связан с Payment отношением 1:N

### Приложение Б. API Endpoints

Полный список REST API endpoints:

Authentication:

POST /api/v1/auth/register/ - регистрация
POST /api/v1/auth/login/ - получение токена
POST /api/v1/auth/logout/ - выход
POST /api/v1/auth/refresh/ - обновление токена
POST /api/v1/auth/verify/ - проверка токена

Profiles:

GET /api/v1/profiles/me/ - получение профиля
PATCH /api/v1/profiles/me/ - обновление профиля
POST /api/v1/profiles/upload-avatar/ - загрузка аватара

Memberships:

GET /api/v1/memberships/types/ - список типов абонементов
GET /api/v1/memberships/types/{id}/ - детали типа абонемента
GET /api/v1/memberships/my/ - мои абонементы
POST /api/v1/memberships/purchase/ - покупка абонемента

Classes:

GET /api/v1/classes/ - список занятий
GET /api/v1/classes/{id}/ - детали занятия
GET /api/v1/classes/schedule/ - расписание

Bookings:

GET /api/v1/bookings/my/ - мои бронирования
POST /api/v1/bookings/ - создание бронирования
DELETE /api/v1/bookings/{id}/cancel/ - отмена бронирования

Payments:

GET /api/v1/payments/my/ - история платежей
POST /api/v1/payments/create/ - создание платежа
POST /api/v1/payments/webhook/ - webhook от платёжной системы

Trainers:

GET /api/v1/trainers/ - список тренеров
GET /api/v1/trainers/{id}/ - детали тренера

AI Trainer:

POST /api/v1/ai-trainer/workout-plan/ - план тренировок
POST /api/v1/ai-trainer/nutrition-plan/ - план питания
GET /api/v1/ai-trainer/recommend-classes/ - рекомендации занятий

### Приложение В. Переменные окружения

Файл .env для настройки:

Django:

SECRET_KEY - секретный ключ приложения
DEBUG - режим отладки (True или False)
ALLOWED_HOSTS - разрешённые хосты через запятую

Database:

DATABASE_URL - URL подключения к PostgreSQL

Email:

EMAIL_HOST - SMTP сервер
EMAIL_PORT - порт SMTP
EMAIL_USE_TLS - использование TLS
EMAIL_HOST_USER - логин email
EMAIL_HOST_PASSWORD - пароль email

Celery:

CELERY_BROKER_URL - URL Redis брокера

YooKassa:

YOOKASSA_SHOP_ID - идентификатор магазина
YOOKASSA_SECRET_KEY - секретный ключ
USE_MOCK_PAYMENTS - использование mock-сервиса (True для демо)

Anthropic Claude:

ANTHROPIC_API_KEY - ключ API

### Приложение Г. Инструкция по развёртыванию

Шаги для запуска проекта:

1. Клонировать репозиторий
2. Создать виртуальное окружение командой python -m venv venv
3. Активировать виртуальное окружение
4. Установить зависимости командой pip install -r requirements.txt
5. Создать файл .env с настройками на основе .env.example
6. Применить миграции командой python manage.py migrate
7. Создать суперпользователя командой python manage.py createsuperuser
8. Загрузить тестовые данные командой python manage.py loaddata fixtures/initial_data.json
9. Запустить сервер разработки командой python manage.py runserver
10. В отдельном терминале запустить Celery worker командой celery -A config worker -l info
11. В третьем терминале запустить Celery beat командой celery -A config beat -l info

Доступ к системе:

Web-интерфейс доступен по адресу http://localhost:8000
API доступен по адресу http://localhost:8000/api/v1/
Admin-панель доступна по адресу http://localhost:8000/admin/
